Feature: Аутентификация пользователя
  Как зарегистрированный пользователь
  Я хочу входить в систему
  Чтобы получить доступ к своему аккаунту

  Background:
    Given система аутентификации запущена
    And в базе данных есть пользователь:
      | email          | password   | name       |
      | user@test.com  | Pass1234   | Test User  |

  Rule: Безопасность учетных данных
    Система должна защищать учетные данные пользователей

  Scenario: Успешный вход с правильными учетными данными
    Given я ввожу email "user@test.com"
    And я ввожу пароль "Pass1234"
    When я отправляю форму входа
    Then я должен получить JWT токен
    And в ответе должен быть объект пользователя без пароля

  Scenario: Неуспешный вход с неправильным паролем
    Given я ввожу email "user@test.com"
    And я ввожу пароль "WrongPassword"
    When я отправляю форму входа
    Then я должен получить ошибку аутентификации
    And система должна вернуть сообщение "Invalid email or password"

  Scenario: Попытка входа несуществующего пользователя
    Given я ввожу email "nonexistent@test.com"
    And я ввожу пароль "anypassword"
    When я отправляю форму входа
    Then я должен получить ошибку аутентификации
    And система должна вернуть сообщение "Invalid email or password"

  Scenario Outline: Нагрузочное тестирование входа пользователей
    Given в системе зарегистрировано <users_count> пользователей
    When происходит <requests_count> одновременных запросов на вход
    Then среднее время ответа должно быть менее <max_response_time> мс
    And процент успешных ответов должен быть более <success_rate>%

    Examples:
      | users_count   | requests_count   | max_response_time | success_rate |
      | 1000         | 1000            | 1000              | 95           |
      | 5000         | 5000            | 1500              | 90           |
      | 10000        | 10000           | 2000              | 90           |
      | 50000        | 50000           | 5000              | 85           |
      