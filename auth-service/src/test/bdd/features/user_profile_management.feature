Feature: Управление профилем пользователя
  Как авторизованный пользователь
  Я хочу управлять своим профилем
  Чтобы поддерживать актуальность моих данных

  Background:
    Given система аутентификации запущена
    And я авторизован как пользователь с id "user-123"

  Rule: Конфиденциальность данных
    Пользователь может изменять только свои данные

  Business Idea: Персонализированный опыт использования
    Предоставление пользователям возможности кастомизировать свои профили
    повышает вовлеченность и удовлетворенность сервисом

  Scenario: Получение профиля текущего пользователя
    Given я авторизован с токеном пользователя
    When я запрашиваю свой профиль
    Then я должен получить данные своего профиля
    And в ответе не должно быть поля password

  Scenario: Обновление имени пользователя
    Given я хочу изменить свое имя на "<new_name>"
    When я отправляю запрос на обновление профиля
    Then мой профиль должен быть обновлен
    And в базе данных должно быть сохранено новое имя

    Examples:
      | new_name       |
      | Новое Имя      |
      | Иван Петров    |
      | Алиса          |

  Scenario: Сравнение алгоритмов хеширования паролей
    Given я аутентифицируюсь с паролем "<password>"
    When система хеширует пароль с использованием bcrypt
    And система хеширует тот же пароль с использованием MD5
    Then время хеширования bcrypt должно быть больше времени MD5
    And безопасность bcrypt должна быть выше, чем MD5

    Examples:
      | password         | length |
      | simple           | 6      |
      | MediumPassword1  | 15     |
      | VeryLongAndComplexPassword123!@# | 32 |
      | aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa | 32 |